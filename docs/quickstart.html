<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quickstart &mdash; dish 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction into dish" href="introduction.html" />
    <link rel="prev" title="Setup" href="setup.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            dish
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-wave-function">The wave function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuring-the-solving-parameters">Configuring the solving parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-grid">The Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-better-grid-for-integration-purposes">A better grid for integration purposes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-adams-moulton-method">The Adams-Moulton method</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-indir-function">The <code class="docutils literal notranslate"><span class="pre">indir</span></code> function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#functions-classes-used-in-this-quickstart">Functions/Classes used in this Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dish.dirac.solver.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.atomic_units.convert_units"><code class="docutils literal notranslate"><span class="pre">convert_units()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.atom.Nucleus"><code class="docutils literal notranslate"><span class="pre">Nucleus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dish.util.atom.Nucleus.potential"><code class="docutils literal notranslate"><span class="pre">Nucleus.potential()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.atom.QuantumNumberSet"><code class="docutils literal notranslate"><span class="pre">QuantumNumberSet</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.atom.parse_atomic_term_symbol"><code class="docutils literal notranslate"><span class="pre">parse_atomic_term_symbol()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.misc.SolvingResult"><code class="docutils literal notranslate"><span class="pre">SolvingResult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.radial.grid.DistanceGrid"><code class="docutils literal notranslate"><span class="pre">DistanceGrid</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dish.util.radial.grid.RombergIntegrationGrid"><code class="docutils literal notranslate"><span class="pre">RombergIntegrationGrid</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction into dish</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dish</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quickstart</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quickstart.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quickstart">
<h1>Quickstart<a class="headerlink" href="#quickstart" title="Link to this heading"></a></h1>
<p>All calculations internally are performed dimensionless using <a class="reference external" href="https://en.wikipedia.org/wiki/Hartree_atomic_units">Hartree atomic units</a>.
All classes and functions therefore expect values in atomic units.
To convert between units of the SI system and atomic units <em>dish</em> provides the method <a class="reference internal" href="#dish.util.atomic_units.convert_units" title="dish.util.atomic_units.convert_units"><code class="xref py py-func docutils literal notranslate"><span class="pre">convert_units</span></code></a>.</p>
<p>It returns the converted value of <em>value</em> (given in <em>old_unit</em>) in <em>new_unit</em>.
(Simplified this returns <code class="docutils literal notranslate"><span class="pre">value</span> <span class="pre">*</span> <span class="pre">new_unit</span> <span class="pre">/</span> <span class="pre">old_unit</span></code>).
! You need to assure that <em>old_unit</em> and <em>new_unit</em> have the same dimension as there are no checks performed!
<em>old_unit</em> and <em>new_unit</em> can be either numerical values or strings for the most common units (e.g. “E_h”, “eV”, “J”).</p>
<p>To calculate electronic states of a Hydrogen-like system first the properties of the <a class="reference internal" href="#dish.util.atom.Nucleus" title="dish.util.atom.Nucleus"><code class="xref py py-class docutils literal notranslate"><span class="pre">Nucleus</span></code></a> need to be specified.
<em>dish</em> has build-in support for either a point-like nucleus (a pure Coulomb potential), a homogeneously charged ball-like nucleus or a nucleus which charge is described by a Fermi distribution:</p>
<div class="math notranslate nohighlight">
\[\rho(r) = \frac{\rho_0}{1+\exp((r-c)/a)}\]</div>
<p>Therefore, to following properties need to be specified:</p>
<ol class="arabic">
<li><p>The nuclear charge <em>Ze</em> passed to the parameter <code class="docutils literal notranslate"><span class="pre">Z</span></code>.</p></li>
<li><p>The mass of the nucleus <code class="docutils literal notranslate"><span class="pre">M</span></code>. To perform calculations with a fixed core this can be set to <em>numpy.inf</em> .</p></li>
<li><p>Parameters of the charge distribution.
The radius can be either given as the root mean squared radius <span class="math notranslate nohighlight">\(R_\text{rms} \sqrt{\langle r^2 \rangle}\)</span> via the parameter <code class="docutils literal notranslate"><span class="pre">R_rms</span></code>,
for a ball-like model as the radius <span class="math notranslate nohighlight">\(R_0\)</span> via the parameter <code class="docutils literal notranslate"><span class="pre">R0</span></code>
or for a Fermi charge density distribution as the parameter <span class="math notranslate nohighlight">\(c\)</span> via the constructor parameter of the same name.</p>
<p>If a value is passed to one of the three parameters the others are calculated if possible.
For a point-like model this must not be passed.</p>
<p>For a Fermi model also the <em>diffuseness</em> parameter <span class="math notranslate nohighlight">\(a\)</span> is required.
It can be passed explicitly to the constructor via the parameter <code class="docutils literal notranslate"><span class="pre">a</span></code> but defaults
to <span class="math notranslate nohighlight">\(2.3 \text{fm} /a_0 / (4\cdot\ln(3))\)</span> as this is a good approximation for most stable nuclei (<em>Parpia and Mohanty, Phys.Rev.A, 46 (1992), Number 7</em>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For small nuclei the Fermi-parameter <span class="math notranslate nohighlight">\(c\)</span> can not be derived from <span class="math notranslate nohighlight">\(R_\text{rms}\)</span> as the model
can’t be applied with the default value of <span class="math notranslate nohighlight">\(a\)</span>.</p>
</div>
</li>
</ol>
<p>An example for Ca19+ looks like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dish</span> <span class="kn">import</span> <span class="n">Nucleus</span><span class="p">,</span> <span class="n">convert_units</span>

<span class="n">nuc</span> <span class="o">=</span> <span class="n">Nucleus</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
              <span class="n">R_rms</span><span class="o">=</span><span class="n">convert_units</span><span class="p">(</span><span class="s2">&quot;fm&quot;</span><span class="p">,</span> <span class="s2">&quot;a_0&quot;</span><span class="p">,</span> <span class="mf">3.4776</span><span class="p">),</span>
              <span class="n">M</span><span class="o">=</span><span class="n">convert_units</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">,</span> <span class="s2">&quot;m_e&quot;</span><span class="p">,</span> <span class="mf">40.078</span><span class="p">)</span>
              <span class="p">)</span>
</pre></div>
</div>
<p>Then the electronic state which should be calculated should be specified.
This can be either done be passing the quantum numbers a tuple <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">l,</span> <span class="pre">j)</span></code> (e.g. <em>(2, 0, 1/2)</em>)
or by passing the atomic term symbol as a string <code class="docutils literal notranslate"><span class="pre">&quot;&lt;n&gt;&lt;l-alias&gt;&lt;j&gt;&quot;</span></code> (e.g. <em>“2s1/2”</em>).
For the latter one there is another possible notation: <code class="docutils literal notranslate"><span class="pre">&lt;n&gt;[&lt;l&gt;]&lt;+/-&gt;</span></code> (e.g. <em>“2s1/2 == 2[0]+</em>) where the name for the angular-momentum number can be substituted by the value in brackets
and as only single electron systems are calculated <em>j</em> will always be <span class="math notranslate nohighlight">\(l\pm1/2\)</span> which can be passed by a <em>+</em> or a <em>-</em>.
A mixture of the latter two variants is possible.</p>
<p>From the string a <a class="reference internal" href="#dish.util.atom.QuantumNumberSet" title="dish.util.atom.QuantumNumberSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumNumberSet</span></code></a> object will be constructed
using the <a class="reference internal" href="#dish.util.atom.parse_atomic_term_symbol" title="dish.util.atom.parse_atomic_term_symbol"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_atomic_term_symbol</span></code></a> function.
You can also pass a <a class="reference internal" href="#dish.util.atom.QuantumNumberSet" title="dish.util.atom.QuantumNumberSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">QuantumNumberSet</span></code></a> object directly.</p>
<p>For example the <span class="math notranslate nohighlight">\(3p_{1/2}\)</span> state can be specified the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;3p+&quot;</span>
<span class="c1"># which is equivalent to</span>
<span class="n">state</span> <span class="o">=</span> <span class="s2">&quot;3[2]1/2</span>
</pre></div>
</div>
<p>After specifying this properties one can run the solving algorithm. In a minimal setup the function call to <a class="reference internal" href="#dish.dirac.solver.solve" title="dish.dirac.solver.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">solve</span></code></a> looks like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dish</span> <span class="kn">import</span> <span class="n">solve</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">nucleus</span><span class="o">=</span><span class="n">nuc</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, for the nuclear potential the Fermi model is used.
To change this pass the alias of the potential model a string to the <code class="docutils literal notranslate"><span class="pre">potential_model</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">nucleus</span><span class="o">=</span><span class="n">nuc</span><span class="p">,</span>
               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
               <span class="n">potential_model</span><span class="o">=</span><span class="s2">&quot;Fermi&quot;</span>  <span class="c1"># other options are &quot;ball&quot;==&quot;uniform&quot; or &quot;pointlike&quot;==&quot;coulomb&quot;</span>
               <span class="p">)</span>
</pre></div>
</div>
<p>After the solving process the wave function can be obtained from the <a class="reference internal" href="#dish.util.misc.SolvingResult" title="dish.util.misc.SolvingResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">SolvingResult</span></code></a> object which is stored in <em>result</em> via</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Psi</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">wave_function</span>
</pre></div>
</div>
<section id="the-wave-function">
<h2>The wave function<a class="headerlink" href="#the-wave-function" title="Link to this heading"></a></h2>
<p>has the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\psi_{n \kappa m}(\overline{r})  = \frac{1}{r} \begin{pmatrix} i f_{n\kappa} (r) \Omega_{\kappa, m}(\theta, \varphi) \\ g_{n\kappa}(r) \Omega_{-\kappa,m}(\theta, \varphi) \end{pmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\((r, \theta, \varphi)\)</span> are spherical coordinates and <span class="math notranslate nohighlight">\(\Omega_{\kappa, m}\)</span> is a spherical spinor.
It is stored in a <a class="reference internal" href="introduction.html#dish.util.radial.wave_function.RadialDiracWaveFunction" title="dish.util.radial.wave_function.RadialDiracWaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadialDiracWaveFunction</span></code></a> object which stores the array of points where the wave function is evaluated in the field <em>r</em>, the large component <span class="math notranslate nohighlight">\(f_\kappa\)</span> in the field <em>f</em> and the small component <span class="math notranslate nohighlight">\(g_\kappa\)</span> in the field <em>g</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Psi</span><span class="o">.</span><span class="n">r</span>  <span class="c1"># grid points -&gt; stored in a numpy array</span>
<span class="n">Psi</span><span class="o">.</span><span class="n">f</span>  <span class="c1"># large component values at the grid points -&gt; stored in a numpy array</span>
<span class="n">Psi</span><span class="o">.</span><span class="n">g</span>  <span class="c1"># small component values at the grid points -&gt; stored in a numpy array</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To allow further calculations (mainly the calculation of [matrix elements](#calculating-matrix-elements))
in opposite to literature <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(g\)</span> are stored like above (without the factor <span class="math notranslate nohighlight">\(\frac{1}{r}\)</span>) to minimize loss of accuracy due to unnecessary rounding.</p>
</div>
<p>The energy of the <em>state</em> is stored in the field <em>energy</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="o">.</span><span class="n">energy</span>
</pre></div>
</div>
</section>
<section id="configuring-the-solving-parameters">
<h2>Configuring the solving parameters<a class="headerlink" href="#configuring-the-solving-parameters" title="Link to this heading"></a></h2>
<p>The solving algorithm uses a finite-differences approach to solve the coupled system of equations for the large and small component.
The energy is searched for which both components can be found continuous.
To numerically solve the Dirac equation an <a class="reference external" href="https://en.wikipedia.org/wiki/Linear_multistep_method#Adams%E2%80%93Moulton_methods">Adams-Moulton method</a> is used.</p>
<p>The parameters of the solving algorithm are chosen based on the state by default and can be adjusted by the user:</p>
<section id="the-grid">
<h3>The Grid<a class="headerlink" href="#the-grid" title="Link to this heading"></a></h3>
<p>The radial grid on which the wave function is evaluated on is an exponential grid of the form</p>
<div class="math notranslate nohighlight">
\[r(t) = r_0 \cdot (\exp(h\cdot t)-1)\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is a linear grid from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(N\)</span>.
This information is stored in a <a class="reference internal" href="#dish.util.radial.grid.DistanceGrid" title="dish.util.radial.grid.DistanceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceGrid</span></code></a> object which can be constructed from the parameters <code class="docutils literal notranslate"><span class="pre">r0</span></code>, <code class="docutils literal notranslate"><span class="pre">h</span></code> and <code class="docutils literal notranslate"><span class="pre">N</span></code> or <code class="docutils literal notranslate"><span class="pre">r_max</span></code> which defines the region where the maximum <span class="math notranslate nohighlight">\(r\)</span> value is evaluated.
It is recommended to regulate <span class="math notranslate nohighlight">\(N\)</span> using the other three parameters and not passing it explicitly.
The grid can be passed to the solve function via the parameter <code class="docutils literal notranslate"><span class="pre">r_grid</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dish</span> <span class="kn">import</span> <span class="n">DistanceGrid</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">nucleus</span><span class="o">=</span><span class="n">nuc</span><span class="p">,</span>
               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
               <span class="n">r_grid</span><span class="o">=</span><span class="n">DistanceGrid</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
               <span class="c1"># another possibility is to pass this using a dictionary which will be parsed internally:</span>
               <span class="c1"># r_grid={&quot;h&quot;: 0.005, &quot;r0&quot;=1e-6, &quot;r_max&quot;=2}</span>
               <span class="c1"># passing N instead of r_max is also possible but more inconvenient</span>
               <span class="c1"># r_grid=DistanceGrid(h=0.005, r0=1e-6, N=20000)</span>
               <span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<div class="line-block">
<div class="line">The more points the grid contains and therefore the smaller <code class="docutils literal notranslate"><span class="pre">r0</span></code> and <code class="docutils literal notranslate"><span class="pre">h</span></code> are chosen the more computation intensive is the solving process.</div>
<div class="line">For <span class="math notranslate nohighlight">\(N \le 10^5\)</span> the Python version provides enough speed that the solving finishes in under a second of computation time on decent hardware but for larger <code class="docutils literal notranslate"><span class="pre">N</span></code> it is highly recommended to use the Fortran version which speeds up the main part of the solving process by one to two orders of magnitude.</div>
</div>
</div>
</section>
<section id="a-better-grid-for-integration-purposes">
<h3>A better grid for integration purposes<a class="headerlink" href="#a-better-grid-for-integration-purposes" title="Link to this heading"></a></h3>
<p>To calculate matrix elements using the wave functions one needs to solve a radial integral.
Since the grid on which the wave function is evaluated is given due to the method how the wave function is found,
one can either integrate on the exponential grid <span class="math notranslate nohighlight">\(r\)</span> or on the linear grid <span class="math notranslate nohighlight">\(t\)</span> where the latter one is better
suited as the numerical methods to integrate on equidistant points are well understood.
On equidistant grids Newton-Cotes-formulas are used, where the lowest order method, the so-called trapezoid rule,
is the most efficient but also the most inaccurate.</p>
<p>If possible use a <a class="reference internal" href="#dish.util.radial.grid.RombergIntegrationGrid" title="dish.util.radial.grid.RombergIntegrationGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">RombergIntegrationGrid</span></code></a> instead of a <a class="reference internal" href="#dish.util.radial.grid.DistanceGrid" title="dish.util.radial.grid.DistanceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceGrid</span></code></a> since it enables to use Romberg’s method
for approximating the integral which is an improvement of the trapezoidal rule using Richardson extrapolation.
But it requires an equidistant grid with a number of points <span class="math notranslate nohighlight">\(N = 2^k + 1\)</span> where <span class="math notranslate nohighlight">\(k\)</span> is a positive integer.</p>
<p>One can either just construct a <a class="reference internal" href="#dish.util.radial.grid.RombergIntegrationGrid" title="dish.util.radial.grid.RombergIntegrationGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">RombergIntegrationGrid</span></code></a> (which is a subclass of <a class="reference internal" href="#dish.util.radial.grid.DistanceGrid" title="dish.util.radial.grid.DistanceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceGrid</span></code></a>) directly</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dish.util.radial.grid</span> <span class="kn">import</span> <span class="n">RombergIntegrationGrid</span>

<span class="n">r_grid</span> <span class="o">=</span> <span class="n">RombergIntegrationGrid</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
                                <span class="n">r0</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span>
                                <span class="n">k</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
                                <span class="c1"># or N can be passed but needs to fulfill the requirement N = 2^k+1</span>
                                <span class="c1"># N=2**15+1</span>
                                <span class="p">)</span>
</pre></div>
</div>
<p>or a similar grid can be derived from a given <a class="reference internal" href="#dish.util.radial.grid.DistanceGrid" title="dish.util.radial.grid.DistanceGrid"><code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceGrid</span></code></a> <em>grid</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">r_grid</span> <span class="o">=</span> <span class="n">RombergIntegrationGrid</span><span class="o">.</span><span class="n">construct_similar_grid_from_distance_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">h</span></code> parameter is altered so that <code class="docutils literal notranslate"><span class="pre">r_max</span></code> and <code class="docutils literal notranslate"><span class="pre">r0</span></code> are kept constant but there is the right number of points for Romberg integration.
Note that this method will always create a grid where <code class="docutils literal notranslate"><span class="pre">h</span></code> is smaller (or equal) than in the original grid so that there are more or the same number of points.</p>
</section>
<section id="the-adams-moulton-method">
<h3>The Adams-Moulton method<a class="headerlink" href="#the-adams-moulton-method" title="Link to this heading"></a></h3>
<div class="line-block">
<div class="line">Adams-Moulton (AM) methods are a linear multistep method to solve systems of ordinary differential equations numerically on a finite grid.</div>
<div class="line">A multistep method of order <span class="math notranslate nohighlight">\(k\)</span> uses the information if the previous <span class="math notranslate nohighlight">\(k\)</span> points to determine the next point (for a detailed discussion see Chapter (???) of the underlying thesis). Therefore, the AM method requires <span class="math notranslate nohighlight">\(k\)</span> initial values.</div>
<div class="line">In the algorithm the AM method is used from the most inner points in the outward direction and inwards from the most outer points.</div>
<div class="line">The initial values are calculated from asymptotic considerations. The order of the method to retrieve the initial values for the inward integration can be specified by the parameter <code class="docutils literal notranslate"><span class="pre">order_indir</span></code>.</div>
<div class="line">The order of the AM itself can be set via <code class="docutils literal notranslate"><span class="pre">order_AM</span></code>.</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">nucleus</span><span class="o">=</span><span class="n">nuc</span><span class="p">,</span>
               <span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span>
               <span class="n">order_AM</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>    <span class="c1"># default value that has proven to be reliable</span>
               <span class="n">order_indir</span><span class="o">=</span><span class="mi">7</span>  <span class="c1"># default value</span>
               <span class="p">)</span>
</pre></div>
</div>
<p>Usually there is no need to modify this values but for some wave functions that oscillate quickly near the origin it might help to increase the order of the AM method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The higher <code class="docutils literal notranslate"><span class="pre">order_AM</span></code> the more compute intensive is the solving process.</p>
</div>
</section>
<section id="the-indir-function">
<h3>The <code class="docutils literal notranslate"><span class="pre">indir</span></code> function<a class="headerlink" href="#the-indir-function" title="Link to this heading"></a></h3>
<p>To use a <span class="math notranslate nohighlight">\(k^\text{th}\)</span> order multistep method <span class="math notranslate nohighlight">\(k\)</span> initial values are required
in each direction. The initial guesses for the inward direction are obtained from asymptotic assumptions
and the wave function is expanded in a converging series (see chapter ?? of the thesis).
This series converges very fast if <span class="math notranslate nohighlight">\(r\)</span> is large enough in the most outward region and hence
only the first few terms need to be calculated.
The number of terms can be passed via the parameter <code class="docutils literal notranslate"><span class="pre">order_indir</span></code>.
The default value of 7 should be sufficient in most cases.</p>
</section>
</section>
<section id="functions-classes-used-in-this-quickstart">
<h2>Functions/Classes used in this Quickstart<a class="headerlink" href="#functions-classes-used-in-this-quickstart" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="dish.dirac.solver.solve">
<span class="sig-prename descclassname"><span class="pre">dish.dirac.solver.</span></span><span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nucleus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dish.util.atom.Nucleus" title="dish.util.atom.Nucleus"><span class="pre">Nucleus</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#dish.util.atom.QuantumNumberSet" title="dish.util.atom.QuantumNumberSet"><span class="pre">QuantumNumberSet</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dish.util.radial.grid.DistanceGrid" title="dish.util.radial.grid.grid.DistanceGrid"><span class="pre">DistanceGrid</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'h':</span> <span class="pre">0.005,</span> <span class="pre">'r0':</span> <span class="pre">2e-06}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Fermi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_guess</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_AM</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order_indir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dish.util.misc.SolvingResult" title="dish.util.misc.SolvingResult"><span class="pre">SolvingResult</span></a></span></span><a class="headerlink" href="#dish.dirac.solver.solve" title="Link to this definition"></a></dt>
<dd><p>Solve the radial Dirac equation for Hydrogen-like atoms in state ‘state’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nucleus</strong> – parameters of the nucleus</p></li>
<li><p><strong>state</strong> – electron state to find the wave function</p></li>
<li><p><strong>r_grid</strong> – grid on which the wave function is to be evaluated.
Can be constructed from dict.</p></li>
<li><p><strong>potential_model</strong> – model of the charge distribution of the nucleus.
Either ‘Fermi’, ‘uniform’ (charged ball) or ‘point-like’.
The default is ‘Fermi’.</p></li>
<li><p><strong>m</strong> – mass of the particle for which the SE is solved in m_e.
The default is 1 (for an electron).</p></li>
<li><p><strong>E_guess</strong> – initial guess for the energy of the state.
Can be ‘auto’ which will use the analytical value for a point-like nucleus.
The default is ‘auto’.</p></li>
<li><p><strong>order_AM</strong> – order of the Adams-Moulton procedure which is used to solve the differential equation.
The default is 5.</p></li>
<li><p><strong>order_indir</strong> – order of the procedure which is used to find the most inner points of the wave function.
The default is 7.</p></li>
<li><p><strong>max_number_of_iterations</strong> – number of iterations after which the solving routine will stop.
The default is 20.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the Dirac solving routine ‘master’ and additional information about the solving process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#dish.util.misc.SolvingResult" title="dish.util.misc.SolvingResult">SolvingResult</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dish.util.atomic_units.convert_units">
<span class="sig-prename descclassname"><span class="pre">dish.util.atomic_units.</span></span><span class="sig-name descname"><span class="pre">convert_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">old_unit_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_unit_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.atomic_units.convert_units" title="Link to this definition"></a></dt>
<dd><div class="line-block">
<div class="line">Convert ‘value’ in unit ‘old_unit’ to ‘new_unit’.</div>
<div class="line">! You need to assure that these values are of the same dimension !</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_unit</strong> – either the old units name or the conversion value into SI units</p></li>
<li><p><strong>new_unit</strong> – either the new units name or the conversion value into SI units</p></li>
<li><p><strong>value</strong> – value to convert. The default is 1 to just obtain the conversion factor.</p></li>
<li><p><strong>old_unit_exp</strong> – exponent of the old unit. The default is 1.</p></li>
<li><p><strong>new_unit_exp</strong> – exponent of the new unit. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>converted value</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dish.util.atom.Nucleus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dish.util.atom.</span></span><span class="sig-name descname"><span class="pre">Nucleus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_rms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9.890591475522296e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_charge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.atom.Nucleus" title="Link to this definition"></a></dt>
<dd><div class="line-block">
<div class="line">Dataclass to store the properties of the nucleus.</div>
<div class="line">The potential for point-like, ball-like and Fermi charge distributions is provided through the <a class="reference internal" href="#dish.util.atom.Nucleus.potential" title="dish.util.atom.Nucleus.potential"><code class="xref py py-meth docutils literal notranslate"><span class="pre">potential()</span></code></a> method.</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Z</strong> – number of protons in the nucleus == nuclear charge</p></li>
<li><p><strong>M</strong> – (optional) mass of the nucleus.</p></li>
<li><p><strong>R_rms</strong> – (optional) root mean squared charge radius of the nucleus. If this is specified</p></li>
<li><p><strong>R0</strong> – (optional) radius of a homogeneously charged sphere. Usually calculated from R_rms.</p></li>
<li><p><strong>c</strong> – (optional) Fermi charge distribution parameter <em>c</em>. Usually calculated from the R_rms.</p></li>
<li><p><strong>a</strong> – (optional) diffuseness parameter for a Fermi distribution. Defaults to <span class="math notranslate nohighlight">\(2.3 \text{fm} /a_0 / (4\cdot\ln(3))\)</span> as described in <em>Parpia and Mohanty, Phys.Rev.A, 46 (1992), Number 7</em>.</p></li>
<li><p><strong>system_charge</strong> – (optional) charge of the hydrogenic atom. Defaults to <em>Z-1</em>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dish.util.atom.Nucleus.potential">
<span class="sig-name descname"><span class="pre">potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Fermi'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.atom.Nucleus.potential" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – point(s) where the value of the potential should be evaluated</p></li>
<li><p><strong>model</strong> – (optional) alias for the type of the potential model. Choose from “Fermi”, “ball-like”, “point-like”==”Coulomb”. Defaults to “Fermi”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Values of the nucleus’ potential in distance <em>r</em></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float or np.ndarray, same as <em>r</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dish.util.atom.QuantumNumberSet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dish.util.atom.</span></span><span class="sig-name descname"><span class="pre">QuantumNumberSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.atom.QuantumNumberSet" title="Link to this definition"></a></dt>
<dd><p>A container class to store the quantum numbers n, l and j.
<span class="math notranslate nohighlight">\(\kappa\)</span> is calculated for convenience.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – principal quantum number</p></li>
<li><p><strong>l</strong> – orbital angular momentum quantum number</p></li>
<li><p><strong>j</strong> – (optional) total angular momentum quantum number. For non-relativistic calculations not defined.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dish.util.atom.parse_atomic_term_symbol">
<span class="sig-prename descclassname"><span class="pre">dish.util.atom.</span></span><span class="sig-name descname"><span class="pre">parse_atomic_term_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#dish.util.atom.QuantumNumberSet" title="dish.util.atom.QuantumNumberSet"><span class="pre">QuantumNumberSet</span></a></span></span><a class="headerlink" href="#dish.util.atom.parse_atomic_term_symbol" title="Link to this definition"></a></dt>
<dd><p>Parse the atomic term symbol into quantum numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbol</strong> – <p>spectroscopic representation of the electronic state</p>
<p>format: ‘&lt;n&gt;&lt;l&gt;&lt;j&gt;’,
where &lt;n&gt; is the integer value,
&lt;l&gt; can be either the spectroscopic symbol (s,p,d,…) or an integer in brackets ([1], [2], …)
and &lt;j&gt; can be either an explicit integer/2 or +/- .</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>”2s1/2” == “2[0]+”, “15d3/2” == “15[2]-”</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dish.util.atom.QuantumNumberSet" title="dish.util.atom.QuantumNumberSet">QuantumNumberSet</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dish.util.misc.SolvingResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dish.util.misc.</span></span><span class="sig-name descname"><span class="pre">SolvingResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dish.util.atom.QuantumNumberSet" title="dish.util.atom.QuantumNumberSet"><span class="pre">dish.util.atom.QuantumNumberSet</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dish.util.atom.Nucleus" title="dish.util.atom.Nucleus"><span class="pre">dish.util.atom.Nucleus</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dish.util.radial.grid.DistanceGrid" title="dish.util.radial.grid.grid.DistanceGrid"><span class="pre">dish.util.radial.grid.grid.DistanceGrid</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dish.util.radial.wave_function.RadialWaveFunction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_convergence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solving_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dish.util.misc.SolvingParameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solving_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.misc.SolvingResult" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dish.util.radial.grid.DistanceGrid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dish.util.radial.grid.</span></span><span class="sig-name descname"><span class="pre">DistanceGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.radial.grid.DistanceGrid" title="Link to this definition"></a></dt>
<dd><p>Class to hold the information about the grid and the grid points itself.
The grid is constructed lazily, i.e. the grid points are calculated the first time they are required.
The grid has the form <span class="math notranslate nohighlight">\(r(t) = r0 \cdot \left(\exp{t} - 1\right)\)</span> where <span class="math notranslate nohighlight">\(t(i) = i\cdot h\)</span> is a linear grid with <code class="docutils literal notranslate"><span class="pre">N</span></code> points.
The number of values <code class="docutils literal notranslate"><span class="pre">N</span></code> can be constructed from the maximal r value <code class="docutils literal notranslate"><span class="pre">r_max</span></code>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dish.util.radial.grid.RombergIntegrationGrid">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dish.util.radial.grid.</span></span><span class="sig-name descname"><span class="pre">RombergIntegrationGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dish.util.radial.grid.RombergIntegrationGrid" title="Link to this definition"></a></dt>
<dd><p>Class to hold the information about the grid and the grid points itself.
The grid is constructed lazily, i.e. the grid points are calculated the first time they are required.
The grid has the form <span class="math notranslate nohighlight">\(r(t) = r0 \cdot \left(\exp{t} - 1\right)\)</span> where <span class="math notranslate nohighlight">\(t(i) = i \cdot h\)</span> is a linear grid with <code class="docutils literal notranslate"><span class="pre">N</span></code> points.</p>
<p>The number of grid points <code class="docutils literal notranslate"><span class="pre">N</span></code> needs to be of the form <span class="math notranslate nohighlight">\(N = 2^k + 1\)</span> where k is a positive integer.
By using this number of grid points this grid is suited to perform Romberg integration on it which yields more accurate results than the naive trapezoidal rule.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="setup.html" class="btn btn-neutral float-left" title="Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="introduction.html" class="btn btn-neutral float-right" title="Introduction into dish" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Christopher Mertens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>